<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Messenger - Facebook</title>
    <link rel="stylesheet" href="/css/messages.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <a href="/html/home.html" class="logo">
                <svg viewBox="0 0 36 36" fill="currentColor" height="40" width="40">
                    <path d="M20.5 2.5c-6.9 0-12.5 5.3-12.5 11.8 0 3.7 1.9 7 4.9 9.2v5l4.8-2.6c1.3.3 2.6.5 3.9.5 6.9 0 12.5-5.3 12.5-11.8S27.4 2.5 20.5 2.5z"></path>
                </svg>
                <span>Messenger</span>
            </a>
        </div>
        
        <div class="header-center">
            <div class="search-box">
                <svg viewBox="0 0 16 16" width="16" height="16" fill="currentColor">
                    <g fill-rule="evenodd" transform="translate(-448 -544)">
                        <path d="M10.743 2.257a6 6 0 1 1-8.485 8.486 6 6 0 0 1 8.485-8.486zm-1.06 1.06a4.5 4.5 0 1 0-6.365 6.364 4.5 4.5 0 0 0 6.364-6.363z" transform="translate(448 544)"></path>
                        <path d="M10.39 8.75a2.94 2.94 0 0 0-.199.432c-.155.417-.23.849-.172 1.284.055.415.232.794.54 1.103a.75.75 0 0 0 1.112-1.004l-.051-.057a.39.39 0 0 1-.114-.24c-.021-.155.014-.356.09-.563.031-.081.06-.145.08-.182l.012-.022a.75.75 0 1 0-1.299-.752z" transform="translate(448 544)"></path>
                        <path d="M9.557 11.659c.038-.018.09-.04.15-.064.207-.077.408-.112.562-.092.08.01.143.034.198.077l.041.036a.75.75 0 0 0 1.06-1.06 1.881 1.881 0 0 0-1.103-.54c-.435-.058-.867.018-1.284.175-.189.07-.336.143-.433.2a.75.75 0 0 0 .624 1.356l.066-.027.12-.061z" transform="translate(448 544)"></path>
                        <path d="m13.463 15.142-.04-.044-3.574-3.574a.75.75 0 0 0-1.061 1.06l3.574 3.575.04.044a1.5 1.5 0 0 0 2.12-2.12z" transform="translate(448 544)"></path>
                    </g>
                </svg>
                <input type="text" id="searchConversations" placeholder="Tìm kiếm trong Messenger">
            </div>
        </div>
        
        <div class="header-right">
            <div class="user-menu">
                <div class="avatar" id="userAvatar">U</div>
                <div class="dropdown" id="userDropdown">
                    <div class="dropdown-item" onclick="goToProfile()">
                        <div class="avatar small" id="dropdownAvatar">U</div>
                        <span id="dropdownUsername">User</span>
                    </div>
                    <div class="dropdown-divider"></div>
                    <div class="dropdown-item" onclick="logout()">
                        <span>Đăng xuất</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="messenger-container">
        <!-- Sidebar - Conversations List -->
        <div class="conversations-sidebar">
            <div class="sidebar-header">
                <h2>Đoạn chat</h2>
            </div>
            
            <div class="conversations-list" id="conversationsList">
                <!-- Conversations will be loaded here -->
                <div class="loading">Đang tải...</div>
            </div>
        </div>

        <!-- Chat Area -->
        <div class="chat-area" id="chatArea">
            <div class="no-conversation-selected">
                <svg viewBox="0 0 80 80" width="80" height="80">
                    <path d="M0 40C0 17.9 17.9 0 40 0s40 17.9 40 40-17.9 40-40 40S0 62.1 0 40zm40-8c-4.4 0-8 3.6-8 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8zm12-16c-4.4 0-8 3.6-8 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8zM28 16c-4.4 0-8 3.6-8 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8z" fill="#0084FF"></path>
                </svg>
                <h3>Chọn một cuộc trò chuyện</h3>
                <p>Chọn từ các cuộc trò chuyện hiện có hoặc bắt đầu cuộc trò chuyện mới</p>
            </div>

            <!-- Chat Window (will be shown when a conversation is selected) -->
            <div class="chat-window" id="chatWindow" style="display: none;">
                <div class="chat-header">
                    <div class="chat-header-info">
                        <div class="avatar medium" id="chatPartnerAvatar">U</div>
                        <div class="chat-header-text">
                            <h3 id="chatPartnerName">Username</h3>
                            <span class="status">Đang hoạt động</span>
                        </div>
                    </div>
                </div>

                <div class="messages-container" id="messagesContainer">
                    <!-- Messages will be loaded here -->
                </div>

                <div class="message-input-container">
                    <!-- Image preview -->
                    <div id="imagePreviewContainer" style="display: none; padding: 8px 16px; border-top: 1px solid #e4e6eb;">
                        <div style="position: relative; display: inline-block;">
                            <img id="imagePreview" style="max-width: 200px; max-height: 200px; border-radius: 8px;">
                            <button onclick="clearImageSelection()" style="position: absolute; top: 4px; right: 4px; background: rgba(0,0,0,0.7); color: white; border: none; border-radius: 50%; width: 24px; height: 24px; cursor: pointer; display: flex; align-items: center; justify-content: center;">✕</button>
                        </div>
                    </div>
                    
                    <div class="message-input-wrapper">
                        <input type="file" id="imageInput" accept="image/*" style="display: none;" onchange="handleImageSelect(event)">
                        <button class="attach-button" onclick="document.getElementById('imageInput').click()" title="Đính kèm ảnh">
                            <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path>
                            </svg>
                        </button>
                        <input type="text" id="messageInput" placeholder="Aa" autocomplete="off">
                        <button class="send-button" id="sendButton">
                            <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                                <path d="M16.6915026,12.4744748 L3.50612381,13.2599618 C3.19218622,13.2599618 3.03521743,13.4170592 3.03521743,13.5741566 L1.15159189,20.0151496 C0.8376543,20.8006365 0.99,21.89 1.77946707,22.52 C2.41,22.99 3.50612381,23.1 4.13399899,22.8429026 L21.714504,14.0454487 C22.6563168,13.5741566 23.1272231,12.6315722 22.9702544,11.6889879 C22.8132856,10.7464035 22.0274046,9.959333 21.0855918,9.17591516 L4.13399899,0.378452484 C3.34915502,0.0378452484 2.40734225,0.0378452484 1.77946707,0.535381685 C0.994623095,1.18915502 0.837653588,2.27820739 1.15159189,3.06162525 L3.03521743,9.50262823 C3.03521743,9.65972571 3.34915502,9.8168231 3.50612381,9.8168231 L16.6915026,10.6023101 C16.6915026,10.6023101 17.1624089,10.6023101 17.1624089,11.5448945 C17.1624089,12.4874789 16.6915026,12.4744748 16.6915026,12.4744748 Z"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/js/messages.js"></script>
</body>
</html>
